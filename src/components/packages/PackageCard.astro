---
/**
 * PackageCard - Luxury email package display card
 * Features glass morphism, smooth animations, and contextual coloring
 */
import type { EmailPackage } from '../../types';
import { getLocalizedValue } from '../../types/package';
import type { SupportedLang } from '../../lib/i18n';

interface Props {
  package: EmailPackage;
  lang?: SupportedLang;
  recipientCount?: number;
  class?: string;
}

const {
  package: pkg,
  lang = 'en',
  recipientCount,
  class: className = ''
} = Astro.props;

const title = getLocalizedValue(pkg.display.title, lang);
const description = getLocalizedValue(pkg.display.description, lang);
const actualRecipientCount = recipientCount ?? pkg.recipients.ids.length;
---

<article
  class:list={[
    'group relative flex flex-col',
    'bg-surface/80 backdrop-blur-sm',
    'border border-primary/30 rounded-lg overflow-hidden',
    'transition-all duration-300 ease-out',
    'hover:transform hover:-translate-y-1 hover:scale-[1.02]',
    'hover:shadow-2xl hover:shadow-primary/20',
    className
  ]}
>
  <!-- Gradient overlay on hover -->
  <div class="absolute inset-0 bg-gradient-to-br from-white/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none" />

  <!-- Content -->
  <div class="relative p-md flex flex-col flex-1">
    <!-- Header with icon -->
    <div class="flex items-start justify-between gap-sm mb-sm">
      <div class="flex items-center gap-sm">
        <span class="text-2xl" role="img" aria-hidden="true">‚úâÔ∏è</span>
        <span class="text-xs font-medium uppercase tracking-wider text-primary">
          Email
        </span>
      </div>
    </div>

    <!-- Title -->
    <h3 class="text-lg font-bold text-text mb-xs leading-tight">
      {title}
    </h3>

    <!-- Description (truncated) -->
    <p class="text-sm text-text/60 mb-md line-clamp-2 flex-1">
      {description}
    </p>

    <!-- Footer with recipient info -->
    <div class="flex items-center justify-between pt-sm border-t border-white/10">
      <div class="flex items-center gap-xs text-sm text-text/50">
        <span>üë•</span>
        <span>{actualRecipientCount} recipients</span>
      </div>
    </div>
  </div>

  <!-- Actions -->
  <div class="flex border-t border-white/10">
    <button
      type="button"
      class="flex-1 py-sm text-sm font-medium text-text/70 hover:text-text hover:bg-white/5 transition-colors"
      data-action="preview"
      data-package-id={pkg.id}
    >
      üëÅÔ∏è Preview
    </button>
    <div class="w-px bg-white/10" />
    <button
      type="button"
      class="flex-1 py-sm text-sm font-medium text-primary hover:bg-white/5 transition-colors"
      data-action="send"
      data-package-id={pkg.id}
    >
      ‚úâÔ∏è Send Now
    </button>
  </div>
</article>

<style>
  /* Line clamp utility */
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>

